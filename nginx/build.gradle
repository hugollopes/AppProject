/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds/
 */

task copywebbuild(type: Exec, group: "Custom", description: "Distributes reference data"){
   //def dirName = "static"
   //delete dirName //delete bofore copy
    commandLine "rm", "static","-rf"
   doLast {
    exec {
     commandLine "cp", "-r" , "../aioverlord-frontend/dist/static/.", "./static/"
    }
    exec {
       commandLine "cp", "../aioverlord-frontend/dist/index.html", "./static/"
    }
   }
}

task buildImage(type: Exec) {
    dependsOn 'copywebbuild'
    commandLine "docker", "build", ".", "--tag", "localhost:5001/nginx:latest"
}

 task pushImage(type: Exec, group: "Custom", description: "Distributes reference data"){
   dependsOn 'buildImage'
   commandLine "docker", "push","localhost:5001/nginx:latest"
}

task buildnginx(group: "Custom", description: "build nginx prod web server") {
  dependsOn 'pushImage'
}
